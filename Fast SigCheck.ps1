$directory = dir F:\Users  -Directory | Select -Expand BaseName
$SigcheckPath="C:\Windows\temp\sigcheck.exe"

$a =
@(foreach ($dir in $directory) { 
 $filepath = Get-ChildItem F:\Users\$dir -Recurse -ErrorAction SilentlyContinue -Attributes !Directory

 foreach ($file in $filepath){
$file | Where-Object { $_.Fullname -notmatch '.gif|.jpg|.png|.txt|.appicon|.appinfo|.dat' } |  Select -Property FullName,@{Name="MB";Expression={ "{0:N1}" -f ($_.Length / 1MB) }}
 } })


$b = @($a | Where-Object { $_.MB -le 1.0 } | Select -Expand FullName)

foreach ($i in $b)  { & $SigcheckPath -nobanner -c -a -vrs -vt $i | Out-File C:\Users\Admin\Desktop\test\Fun.csv -Append }
   

